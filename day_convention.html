<!DOCTYPE html>
<html lang="en">

<head>

    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="">
    <meta name="author" content="">

    <title>Clean Blog - Sample Post</title>

    <!-- Bootstrap Core CSS -->
    <link href="vendor/bootstrap/css/bootstrap.min.css" rel="stylesheet">

    <!-- Theme CSS -->
    <link href="css/clean-blog.min.css" rel="stylesheet">

    <!-- Code Syntax Highlight CSS -->
    <link href="css/desert.css" rel="stylesheet">


    <!-- Custom Fonts -->
    <link href="vendor/font-awesome/css/font-awesome.min.css" rel="stylesheet" type="text/css">
    <link href='https://fonts.googleapis.com/css?family=Lora:400,700,400italic,700italic' rel='stylesheet' type='text/css'>
    <link href='https://fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800' rel='stylesheet' type='text/css'>

    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
        <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->

</head>

<body>

    <!-- Navigation -->
    <nav class="navbar navbar-default navbar-custom navbar-fixed-top">
        <div class="container-fluid">
            <!-- Brand and toggle get grouped for better mobile display -->
            <div class="navbar-header page-scroll">
                <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
                    <span class="sr-only">Toggle navigation</span>
                    Menu <i class="fa fa-bars"></i>
                </button>
                <a class="navbar-brand" href="index.html">Start Bootstrap</a>
            </div>

            <!-- Collect the nav links, forms, and other content for toggling -->
            <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
                <ul class="nav navbar-nav navbar-right">
                    <li>
                        <a href="index.html">Home</a>
                    </li>
                    <li>
                        <a href="about.html">About</a>
                    </li>
                    <li>
                        <a href="post.html">Sample Post</a>
                    </li>
                    <li>
                        <a href="contact.html">Contact</a>
                    </li>
                </ul>
            </div>
            <!-- /.navbar-collapse -->
        </div>
        <!-- /.container -->
    </nav>

    <!-- Page Header -->
    <!-- Set your background image for this header on the line below. -->
    <header class="intro-header" style="background-image: url('img/post-bg.jpg')">
        <div class="container">
            <div class="row">
                <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                    <div class="post-heading">
                        <h1>Man must explore, and this is exploration at its greatest</h1>
                        <h2 class="subheading">Problems look mighty small from 150 miles up</h2>
                        <span class="meta">Posted by <a href="#">Start Bootstrap</a> on August 24, 2014</span>
                    </div>
                </div>
            </div>
        </div>
    </header>

    <!-- Post Content -->
    <article>
        <div class="container">
            <div class="row">
                <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                    <p>Day Count Convention determines how interest is calculated specifically on fixed income instruments like Bonds, Notes but also for Interest Rate Swaps, Repurchase Agreements and Syndicated Loans. They are used to calcuate Accrued Interest while BUY/SELL of Bonds, calculate interest income and expense for accrual accounting and to calculate interest (coupon) payments or swap reset payments</p>

                    <p>In this article we will go over the different Day Count Basis / Business Day Convention and implement this in Python. This is particularly useful in the Fixed Income Accounting and Derivatives Accounting. </p>

                    <h2 class="section-heading">Fixed Income Coupon Date Fields</h2>

                    <div class="panel panel-primary"> 

                        <div class="panel-heading">Issue Date
                         </div>
                        <div class="panel-body">Issue Date is the date the security was originally issued.
                         </div>
                    </div>

                    <div class="panel panel-primary"> 

                        <div class="panel-heading">Dated Date
                         </div>
                        <div class="panel-body">Dated Date is the date the security first begins accruing
                         </div>
                    </div>

                    <div class="panel panel-primary"> 

                        <div class="panel-heading">First Coupon Date
                         </div>
                        <div class="panel-body">First Coupon Date is the first date that a security pays a coupon
                         </div>
                    </div>

                    <div class="panel panel-primary"> 

                        <div class="panel-heading">Last Coupon Date
                         </div>
                        <div class="panel-body">Last Coupon Date is the last regular coupon period. This can be the Maturity Date in certain securities. This can be a short-length coupon period, long-length coupon period or a normal-length coupon period.
                         </div>
                    </div>

                    <div class="panel panel-primary"> 

                        <div class="panel-heading">Maturity Date
                         </div>
                        <div class="panel-body">Maturity Date is the date that the security matures and repays all outstanding principal and interest
                         </div>
                    </div>

                    <div class="panel panel-primary"> 

                        <div class="panel-heading">Payment Frequency
                         </div>
                        <div class="panel-body">Payment Frequency is the frequency at which a fixed income security pays interest and makes a coupon payment. This can be daily, weekly, monthly, quarterly etc.
                         </div>
                    </div>

                    <h2 class="section-heading">Day Count Convention</h2>

                    <blockquote>The dreams of yesterday are the hopes of today and the reality of tomorrow. Science has not yet mastered prophecy. We predict too much for the next year and yet far too little for the next ten.</blockquote>

                    <table class="table table-hover">
                        <tbody>
                            <tr>
                                <th>Business Day Convention Code </th>
                                <th>Business Day Convention Description</th>
                            </tr>
                            <tr>
                                <td>ADJMBC</td>
                                <td>Modified Business Day Convention - Adjusted</td>
                            </tr>
                            <tr>
                                <td>MBC</td>
                                <td>Modified Business Day Convention - Unadjusted</td>
                            </tr>
                            <tr>
                                <td>ADJFWD</td>
                                <td>Following Business Day Convention - Adjusted</td>
                            </tr>
                            <tr>
                                <td>FWD</td>
                                <td>Following Business Day Convention - UnAdjusted</td>
                            </tr>
                            <tr>
                                <td>ADJBACK</td>
                                <td>Preceding Business Day Convention - Adjusted</td>
                            </tr>
                            <tr>
                                <td>ADJROLL</td>
                                <td>Following Business Day - Adjusted Modified Payment Payment Roll</td>
                            </tr>
                            <tr>
                                <td>BACK</td>
                                <td>Preceding Business Day Convention - Unadjusted</td>
                            </tr>
                        </tbody>
                    </table>                    

                    <a href="#">
                        <img class="img-responsive" src="img/MT54xMessageStructure.png" alt="">
                    </a>
                    <span class="caption text-muted">Life Cycle Events</span>

                    <h2 class="section-heading">Code Walk-through</h2>

                    <p>In this section we will implement some of the helper classes and methods which will be useful for implementing the different day count conventions</p>

                    <blockquote>Workalendar is a package that implements all calendar and its holidays for various countries. Any working day-related computation for most countries are implemented</blockquote>
                    
                    <pre class="prettyprint">
                        <code>
                            # This has the list of day counts and the related convention
                            from workalendar.usa import *
                            from workalendar.europe import *
                            from workalendar.asia import *
                            from workalendar.africa import *

                            class DayCountConv:
                                ACT_ACT = "ACT/ACT"
                                ACT_ACT_ISDA = "ACT/ACT(ISDA)"
                                ACT_360 = "ACT/360"
                                ACT_365 = "ACT/365"
                                ACT_365L = "ACT/365L"
                                ACT_252 = "ACT/252"

                                BASIC30_360 = "30/360"
                                NASD30_360 = "NASD30/360"
                                BASIC30E_360 ="30E/360"

                                BASIC30_365 ="30/365"
                                BASIC30_365L = "30/365L"
                                BASIC30E_365 = "30E/365"
                                BASIC30E_365L = "30E/365L"

                                BASIC30E_ACT = "30E/ACT"
                                BASIC30EP_360 = "30EP/360"

                                CAD_365 = "CAD/365"
                                NL_365 = "NL/365"
                                JPY_365 = "JPY/365"


                            class CalendarFactory:

                                def __init__(self):
                                    self.map = {
                                        "USA": "UnitedStates",
                                        "FRA": "France",
                                        "GRE": "Greece",
                                        "GBR": "UnitedKingdom",
                                        "JPY": "Japan"
                                    }

                                def get(self, countryISO):
                                    return eval("%s()" % self.map[countryISO])
                        </code>
                    </pre>

                    <p>After constructing the Factory method like above, we can then instantiate the calender object for a given country and do methods like get_next_business_day, get_prev_business_day etc</p>

                    <pre class="prettyprint">
                        <code class="language-python">
                            def get_next_business_day(self, coupon_date,iso):
                                cal = CalendarFactory().get(iso)
                                next_day = coupon_date + relativedelta(days=1)
                                while(not cal.is_working_day(next_day)):
                                    next_day = next_day + relativedelta(days=1)
                                return next_day
                        </code>
                    </pre>

                    <pre class="prettyprint">
                        <code class="language-python">
                            def get_prev_business_day(self, coupon_date,iso):
                                cal = CalendarFactory().get(iso)
                                prev_day = coupon_date - relativedelta(days=1)
                                while(not cal.is_working_day(prev_day)):
                                    prev_day = prev_day - relativedelta(days=1)
                                return prev_day
                        </code>
                    </pre>


                    <p>After constructing the Factory method like above, we can then instantiate the calender object for a given country and do methods like get_next_business_day, get_prev_business_day etc</p>

                    <pre class="prettyprint">
                        <code class="language-python">
                        def days_factor(self, prevCouponDate, todayDate,nextCouponDate,day_count_conv, frequency,datedDate,lastIncomeDate,maturityDate,couponPeriod):
                            if day_count_conv == DayCountConv.ACT_ACT:
                                freq = int(frequency[:-2])
                                prevfreq_coupon_date = nextCouponDate + relativedelta(months=-freq)
                                if couponPeriod == 1:
                                    num = (nextCouponDate-prevCouponDate).days
                                    dem = ((nextCouponDate-prevfreq_coupon_date).days * 12.0)/freq
                                    factor = num / dem
                                elif couponPeriod == 0:
                                    factor = freq/12.0
                                else:
                                    factor=1
                            elif day_count_conv == DayCountConv.ACT_360:
                                num = self.days_between(prevCouponDate,nextCouponDate)
                                dem = 360 
                                factor = num / dem
                            elif day_count_conv == DayCountConv.ACT_365:
                                num = self.days_between(prevCouponDate,nextCouponDate)
                                dem = 365 
                                factor = num / dem
                            elif day_count_conv == DayCountConv.ACT_365L:
                                num = self.days_between(prevCouponDate,nextCouponDate)
                                if calendar.isleap(nextCouponDate.year):
                                    dem = 366
                                else:
                                    dem = 365
                                factor = num / dem
                            elif day_count_conv == DayCountConv.ACT_252:
                                if todayDate == None:
                                    num = self.days_between_actual(prevCouponDate,nextCouponDate)
                                else:
                                    num = self.days_between_actual(todayDate,nextCouponDate)
                                dem = 252
                                factor = num / dem

                            elif day_count_conv == DayCountConv.BASIC30_360 or day_count_conv == None:
                                if todayDate == None:
                                    num = self.days_between_actual(prevCouponDate,nextCouponDate)
                                else:
                                    num = self.days_between_actual(todayDate,nextCouponDate)
                                dem = 360
                                factor = num / dem

                            elif day_count_conv == DayCountConv.BASIC30E_360:
                                if todayDate == None:
                                    num = self.days_between_actual(prevCouponDate,nextCouponDate)
                                else:
                                    num = self.days_between_actual(todayDate,nextCouponDate)
                                dem = 360
                                factor = num / dem
                            elif day_count_conv == DayCountConv.BASIC30_365:
                                if todayDate == None:
                                    num = self.days_between_actual_plus(prevCouponDate,nextCouponDate)
                                else:
                                    num = self.days_between_actual_plus(todayDate,nextCouponDate)
                                dem = 365
                                factor = num / dem
                            elif day_count_conv == DayCountConv.BASIC30E_365:
                                if todayDate == None:
                                    num = self.days_between_actual(prevCouponDate,nextCouponDate)
                                else:
                                    num = self.days_between_actual(todayDate,nextCouponDate)
                                dem = 365
                                factor = num / dem
                            elif day_count_conv == DayCountConv.CAD_365:
                                if self.calculate_coupon_period(prevCouponDate,nextCouponDate,frequency,datedDate,lastIncomeDate,maturityDate,day_count_conv) !=0:
                                    num = self.days_between(prevCouponDate,nextCouponDate)
                                    dem = 365 
                                    factor = num / dem
                                else:
                                    factor = 0.5
                            elif day_count_conv == DayCountConv.JPY_365:
                                if self.calculate_coupon_period(prevCouponDate,nextCouponDate,frequency,datedDate,lastIncomeDate,maturityDate,day_count_conv) !=0:
                                    num = self.days_between(prevCouponDate,nextCouponDate)
                                    dem = 365
                                    factor = num / dem
                                else:
                                    factor = 0.5
                                    
                            elif day_count_conv == DayCountConv.NL_365:
                                freq = int(frequency[:-2])
                                if couponPeriod == 1:
                                    num = self.days_between_nl(prevCouponDate,nextCouponDate)
                                    dem = 365 
                                    factor = num / dem
                                elif couponPeriod == 0:
                                    factor = freq/12.0
                                else:
                                    factor=1
                            else:
                                if todayDate == None:
                                    if frequency[-1] == "M":
                                        num = self.days_between_approx(prevCouponDate,nextCouponDate)
                                    else:
                                        num =self.days_between(prevCouponDate,nextCouponDate)
                                else:
                                    num = self.days_between_actual(todayDate,nextCouponDate)
                                dem = 360
                                factor = num / dem

                            return factor
                        </code>
                    </pre>
                </div>
            </div>
        </div>
    </article>

    <hr>

    <!-- Footer -->
    <footer>
        <div class="container">
            <div class="row">
                <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                    <ul class="list-inline text-center">
                        <li>
                            <a href="#">
                                <span class="fa-stack fa-lg">
                                    <i class="fa fa-circle fa-stack-2x"></i>
                                    <i class="fa fa-twitter fa-stack-1x fa-inverse"></i>
                                </span>
                            </a>
                        </li>
                        <li>
                            <a href="#">
                                <span class="fa-stack fa-lg">
                                    <i class="fa fa-circle fa-stack-2x"></i>
                                    <i class="fa fa-facebook fa-stack-1x fa-inverse"></i>
                                </span>
                            </a>
                        </li>
                        <li>
                            <a href="#">
                                <span class="fa-stack fa-lg">
                                    <i class="fa fa-circle fa-stack-2x"></i>
                                    <i class="fa fa-github fa-stack-1x fa-inverse"></i>
                                </span>
                            </a>
                        </li>
                    </ul>
                    <p class="copyright text-muted">Copyright &copy; Your Website 2016</p>
                </div>
            </div>
        </div>
    </footer>

    <!-- jQuery -->
    <script src="vendor/jquery/jquery.min.js"></script>

    <!-- Bootstrap Core JavaScript -->
    <script src="vendor/bootstrap/js/bootstrap.min.js"></script>

    <!-- Contact Form JavaScript -->
    <script src="js/jqBootstrapValidation.js"></script>
    <script src="js/contact_me.js"></script>

    <!-- Theme JavaScript -->
    <script src="js/clean-blog.min.js"></script>

    <script src="https://cdn.rawgit.com/google/code-prettify/master/loader/run_prettify.js"></script>

</body>

</html>
